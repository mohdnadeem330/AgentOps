<template>

	<lightning-record-edit-form object-api-name="DirectDebitRequest__c" onsuccess={handleSuccess}
		onsubmit={handleSubmit} onerror={handleError}>

		<lightning-modal-header label="New Direct Debit Request Creation">
		</lightning-modal-header>


		<lightning-modal-body class="ddrbody">
			<div style="height: 325px;">
				<div class="slds-grid slds-wrap">
					<div class="slds-col slds-size_1-of-2">
						<lightning-combobox name="Account" label="Payer Account" value={dd_DefaultPayerAccount}
							placeholder="Select Payer Account" options={AccountList} onchange={handlePayerAccountChange}
							variant="label-inline" field-level-help="temporaryHelpText" required="true">
						</lightning-combobox>
					</div>
					<div class="slds-col slds-size_1-of-2">
						<lightning-input-field field-name="CustomerIdType__c" onchange={onCustIdTypeChange}
							required="true" value={dd_CustomerIdType}>

						</lightning-input-field>
					</div>
					<div class="slds-col slds-size_1-of-2">
						<lightning-input-field field-name="CustomerIDNumber__c" required="true"
							value={dd_CustomerIDNumber} disabled>
						</lightning-input-field>
					</div>

					<div class="slds-col slds-size_1-of-2">
						<lightning-input-field field-name="CustomerBankAccountType__c" required="true"
							value={dd_CustomerBankAccountType}>
						</lightning-input-field>
					</div>
					<div class="slds-col slds-size_1-of-2">
						<lightning-input-field field-name="CustomerAccountName__c" data-name="CustomerAccountName__c" required="true"
							value={dd_CustomerAccountName}>
						</lightning-input-field>
					</div>

					<div class="slds-col slds-size_1-of-2">
						<lightning-input-field field-name="CustomerBankName__c" required="true">

						</lightning-input-field>
					</div>
					<div class="slds-col slds-size_1-of-2">
						<lightning-input-field field-name="CustomerIBANNumber__c" data-name="CustomerIBANNumber__c" required="true"
							value={dd_CustomerIBANNumber}>
						</lightning-input-field>
					</div>

					<div class="slds-col slds-size_1-of-2" if:false={isServiceRequest}>
						<lightning-input-field field-name="Replicate_same_on_other_Sales_Order__c">
						</lightning-input-field>
					</div>


					<div class="slds-col slds-size_1-of-2">
						<lightning-input-field field-name="Remarks__c"></lightning-input-field>
					</div>
				</div>

				<div class="slds-grid slds-hide">
					<lightning-input-field field-name="Account__c" value={dd_AccountId}>
					</lightning-input-field>
					<lightning-input-field field-name="SalesOrder__c" value={dd_SalesOrderId}>
					</lightning-input-field>
					<lightning-input-field field-name="PayerAccount__c" value={dd_PayerAccount}>
					</lightning-input-field>
				</div>
			</div>
		</lightning-modal-body>


		<lightning-modal-footer>
			<lightning-button class="slds-button" label="Cancel" onclick={handleCloseClick}>
			</lightning-button>
			<lightning-button class="slds-button" variant="brand" type="submit" label="Save">
			</lightning-button>
		</lightning-modal-footer>

	</lightning-record-edit-form>
	<!--Start : Anuroop 02-06-2025 : FIN-49 IBAN Validation - ADCB - Direct debit-->
	<template if:true={showConfirmModal}>
		<section role="dialog" tabindex="-1" aria-modal="true" aria-labelledby="modal-heading-01" class="slds-modal slds-fade-in-open">
			<div class="slds-modal__container">
				<!-- Modal/Popup Box LWC header here -->
				<header class="slds-modal__header">
					<button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" 
							title="Close"
							onclick={closeConfirmModal}>
						<lightning-icon icon-name="utility:close"
							alternative-text="close"
							variant="inverse"
							size="small" ></lightning-icon>
						<span class="slds-assistive-text">Close</span>
					</button>
					<h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Confirm IBAN</h2>
				</header>
				<div class="slds-modal__content slds-p-around_medium confirm-modal" id="modal-content-id-1">
					<p>
						The Customer Name "{dd_CustomerAccountName}" is
						<template if:false={isNameMatching}>&nbsp;not</template>
						&nbsp;matching with the Customer Name "{customerNameFromBank}" from Bank.
						<template if:false={isBlockProcess}> 
							&nbsp;Do you want to proceed with the IBAN Number "{iban}"?
						</template>
						<template if:true={isBlockProcess}>
							&nbsp;Check the IBAN number and try again.
						</template>
					</p>
				</div>
				<footer class="slds-modal__footer" >
					<button class="slds-button slds-button_neutral" onclick={closeConfirmModal} aria-label="Cancel and Close">Close</button>
					<template if:false={isBlockProcess}>
						<button class="slds-button slds-button_brand" onclick={confirmIBAN}>Confirm</button>
					</template>
				</footer>
			</div>
		</section>
		<div class="slds-backdrop slds-backdrop_open" role="presentation"></div>
	</template>
	<!--End : Anuroop 02-06-2025 : FIN-49 IBAN Validation - ADCB - Direct debit-->


	<template if:true={isLoading}>
		<lightning-spinner class="slds-is-relative" alternative-text="Loading..." style="position: absolute;"
			size="medium">
		</lightning-spinner>
	</template>

</template>