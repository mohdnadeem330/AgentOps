<template>
    <template if:true={isCartLoading}>
        <div class="spinner-backdrop">
            <lightning-spinner alternative-text="Loading..." size="large"></lightning-spinner>
        </div>
    </template>

    <div class="slds-p-around_medium">
        <lightning-card title="Unit Search" icon-name="standard:search">
            <div class="content-padding">
                <div class="slds-grid slds-grid_align-end slds-m-bottom_small">
                   <div class="cart-wrapper" title="Delete Units">
    <lightning-button-icon
        icon-name="utility:delete"
        alternative-text="Delete"
        title="Delete Selected Units"
        onclick={handleDeleteUnits}
        variant="bare"
        size="large"
        class="search-icon-button delete-icon">
    </lightning-button-icon>
    <template if:true={selectedCount}>
        <span class="cart-counter">{selectedCount}</span>
    </template>
</div>


                    <!-- Search Icon -->
                    <div title="Search">
                        <lightning-button-icon
                            icon-name="utility:search"
                            alternative-text="Search"
                            title="Search"
                            onclick={handleSearchClick}
                            variant="bare"
                            size="large"
                            class="search-icon-button">
                        </lightning-button-icon>
                    </div>
                </div>

                <!-- Filter Fields -->
                 <div class="slds-grid slds-wrap slds-gutters">
                    <!-- Project -->
                    <div class="slds-col slds-size_1-of-3 slds-p-bottom_x-small" style="position: relative;">
                        <lightning-combobox
                            label="Project"
                            value={selectedProject}
                            options={projectOptions}
                            onchange={handleProjectChange}
                            class="full-width-combobox">
                        </lightning-combobox>
                        <lightning-button-icon
                            icon-name="utility:close"
                            title="Clear Project"
                            onclick={clearProject}
                            variant="bare-inverse"
                            class="clear-icon-button">
                        </lightning-button-icon>
                    </div>

                    <!-- Zone -->
                    <div class="slds-col slds-size_1-of-3 slds-p-bottom_x-small" style="position: relative;">
                        <lightning-combobox
                            label="Zone"
                            value={selectedZone}
                            options={zoneOptions}
                            onchange={handleZoneChange}
                            class="full-width-combobox">
                        </lightning-combobox>
                        <lightning-button-icon
                            icon-name="utility:close"
                            title="Clear Zone"
                            onclick={clearZone}
                            variant="bare-inverse"
                            class="clear-icon-button">
                        </lightning-button-icon>
                    </div>

                    <!-- Building -->
                    <div class="slds-col slds-size_1-of-3 slds-p-bottom_x-small" style="position: relative;">
                        <lightning-combobox
                            label="Building"
                            value={selectedBuilding}
                            options={buildingOptions}
                            onchange={handleBuildingChange}
                            class="full-width-combobox">
                        </lightning-combobox>
                        <lightning-button-icon
                            icon-name="utility:close"
                            title="Clear Building"
                            onclick={clearBuilding}
                            variant="bare-inverse"
                            class="clear-icon-button">
                        </lightning-button-icon>
                    </div>

                    <!-- Unit Type -->
<div class="slds-col slds-size_1-of-3 slds-p-bottom_x-small" style="position: relative;">
    <lightning-combobox
        label="Unit Type"
        value={selectedUnitType}
        options={unitTypeOptions}
        onchange={handleFilterChange}
        class="full-width-combobox">
    </lightning-combobox>
    <lightning-button-icon
        icon-name="utility:close"
        title="Clear Unit Type"
        onclick={clearUnitType}
        variant="bare-inverse"
        class="clear-icon-button">
    </lightning-button-icon>
</div>


                   <!-- Unit Area -->
<div class="slds-col slds-size_1-of-3 slds-p-bottom_x-small" style="position: relative;">
    <lightning-combobox
        label="Unit Area"
        value={selectedUnitArea}
        options={unitAreaOptions}
        onchange={handleFilterChange}
        class="full-width-combobox">
    </lightning-combobox>
    <lightning-button-icon
        icon-name="utility:close"
        title="Clear Unit Area"
        onclick={clearUnitArea}
        variant="bare-inverse"
        class="clear-icon-button">
    </lightning-button-icon>
</div>

                  <!-- View -->
<div class="slds-col slds-size_1-of-3 slds-p-bottom_x-small" style="position: relative;">
    <lightning-combobox
        label="View"
        value={selectedView}
        options={viewOptions}
        onchange={handleFilterChange}
        class="full-width-combobox">
    </lightning-combobox>
    <lightning-button-icon
        icon-name="utility:close"
        title="Clear View"
        onclick={clearView}
        variant="bare-inverse"
        class="clear-icon-button">
    </lightning-button-icon>
</div>


                    <!-- Floor Number -->
                    <div class="slds-col slds-size_1-of-3">
                        <lightning-input label="Floor Number" value={selectedFloorNumber} onchange={handleFilterChange}></lightning-input>
                    </div>

                    <!-- Bedrooms -->
                    <div class="slds-col slds-size_1-of-3">
                        <lightning-input label="Bedrooms" value={selectedBedrooms} onchange={handleFilterChange}></lightning-input>
                    </div>

                    <!-- Bathrooms -->
                    <div class="slds-col slds-size_1-of-3">
                        <lightning-input label="Bathrooms" value={selectedBaths} onchange={handleFilterChange}></lightning-input>
                    </div>

                     <!-- Unit Name -->
                    <div class="slds-col slds-size_2-of-3">
                        <lightning-input type="search" label="Unit Name" value={searchTerm} onchange={handleSearchTermChange}></lightning-input>
                    </div>

                    <!-- Unit Usage -->
<div class="slds-col slds-size_1-of-3 slds-p-bottom_x-small" style="position: relative;">
    <lightning-combobox
        label="Unit Usage"
        value={selectedUnitUsage}
        options={unitUsageOptions}
onchange={handleFilterChange}
        class="full-width-combobox">
    </lightning-combobox>
    <lightning-button-icon
        icon-name="utility:close"
        title="Clear Usage"
        onclick={clearUsage}
        variant="bare-inverse"
        class="clear-icon-button">
    </lightning-button-icon>
</div>


                


                   
                </div>

               <template if:true={isLoading}>
    <div class="spinner-backdrop">
        <lightning-spinner alternative-text="Loading..." size="large"></lightning-spinner>
    </div>
</template>

                <!-- Table of Results -->
                <template if:true={hasUnits}>
                    <div class="slds-m-top_medium">
                        <lightning-datatable key-field="Id" data={filteredUnits} columns={columns}
                            selected-rows={selectedRowIds} onrowselection={handleRowSelection}>
                        </lightning-datatable>
                    </div>
                </template>

                <!-- No Results -->
                <template if:true={noResultsFound}>
                    <p class="slds-m-top_medium slds-text-align_center">No units found</p>
                </template>
            </div>
        </lightning-card>
    </div>
</template>