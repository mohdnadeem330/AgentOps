<template>
	<lightning-card variant="Narrow">
		<div class="btndiv">
			<!-- <lightning-button variant="brand" label="Add Document" title="Primary action" onclick={showCreateDoc}
				class="slds-m-left_x-small"></lightning-button> -->
			<template if:false={noDocuments}>
				<lightning-button variant="Neutral" label="Download" title="Primary action" onclick={downloadAllDocs}
					class="slds-m-left_x-small" disabled={btnDisable}></lightning-button>
			</template>
		</div>
		<!--lightning-icon icon-name="action:new" slot="actions" onclick={showCreateDoc} size="xx-small">
		</lightning-icon>
		<template if:false={noDocuments}>
			<lightning-icon class="slds-m-left_large" icon-name="action:download" slot="actions"
				onclick={downloadAllDocs} size="xx-small">
			</lightning-icon>
		</template-->
		<template if:true={showDocRecModal}>
			<!-- Modal/Popup Box LWC starts here -->
			<section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
				aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
				<div class="slds-modal__container">

					<!-- Modal/Popup Box LWC header here -->
					<header class="slds-modal__header">
						<button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={closeDocRecModal}>
                        <lightning-icon icon-name="utility:close"
                            alternative-text="close"
                            variant="inverse"
                            size="small" ></lightning-icon>
                        <span class="slds-assistive-text">Close</span>
                    </button>
						<h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Create Document</h2>
					</header>
					<!-- Modal/Popup Box LWC body starts here -->

					<div class="slds-modal__content slds-p-around_medium outer-div" id="modal-content-id-1">

						<template if:true={showSpinner}>
							<lightning-spinner alternative-text="Loading" size="medium" variant="brand"
								class="customSpinner">
							</lightning-spinner>
						</template>

						<lightning-combobox name="DocumentType__c" label="Document Type" placeholder="Select type"
							options={documentOptions} onchange={handleChange}></lightning-combobox>
						<template if:true={showOtherName}>
							<lightning-input type="text" label="Other Name" name="Other_Document_Name__c"
								onchange={handleChange}></lightning-input>
						</template>

					</div>
					<!-- Modal/Popup Box LWC footer starts here -->
					<footer class="slds-modal__footer">
						<lightning-button class="slds-m-top_small" variant="brand" onclick={createDocument}
							name="update" label="Create" disabled={btnDisable}>
						</lightning-button>
					</footer>

				</div>
			</section>
			<div class="slds-backdrop slds-backdrop_open"></div>
		</template>
		<template if:true={docRecords}>
			<div class="table-responsive">
				<table class="slds-table_bordered">
					<thead>
						<tr class="slds-line-height_reset">
							<th></th>
							<th>Document Type</th>
							<th>Actions</th>
							<th>Upload Date</th>   <!-- neelesh -->
						</tr>

					</thead>
					<tbody>
						<template for:each={docRecords} for:item="document" for:index="index">
							<tr class="slds-hint-parent" key={document.doc.Id}>
								<td>
									<template if:true={document.availableExternalFile}>
										<lightning-input type="checkbox" checked={document.isCheck} data-index={index} onchange={handleCheck}
											disabled={btnDisable}></lightning-input>
									</template>
								</td>
								<td style="width:170px;">{document.doc.DocumentType__c}
									<template if:true={document.doc.Other_Document_Name__c}>
										&nbsp;-&nbsp;{document.doc.Other_Document_Name__c}</template>
								</td>
								<td>
									<div class="slds-grid slds-wrap">
										<template if:true={document.availableExternalFile}>
											<div class="btnicons">
												
												<lightning-icon icon-name="action:preview" size="x-small" title="Preview" onclick={previewExtFile} data-url={document.externalFileUrl}></lightning-icon>
												
												<lightning-icon icon-name="action:download" onclick={downloadExtFile} data-url={document.externalFileUrl}
													data-filename={document.doc.DocumentType__c} size="x-small" title="Download">
												</lightning-icon>
											</div>
										</template>
										<template if:true={document.availableDoc}>
											<div class="btnicons">
												<lightning-icon icon-name="action:preview" size="x-small"
													data-id={document.contentVersion.ContentDocumentId} onclick={filePreview} title="Preview">
												</lightning-icon>
												<lightning-icon data-name={document.doc.DocumentType__c} data-ext={document.contentVersion.FileExtension}
													data-id={document.contentVersion.ContentDocumentId} icon-name="action:download" slot="actions"
													onclick={downloadDocument} size="x-small" title="Download">
												</lightning-icon>
											</div>
										</template>
										<!-- <template if:false={document.availableDoc}>
											<div class="btnicons">
												<lightning-file-upload accept={acceptedFormats}
													record-id={document.doc.Id} onuploadfinished={handleUploadFinished}>
												</lightning-file-upload> 
												<div>
												<lightning-icon data-id={document.doc.Id} icon-name="action:delete" slot="actions"
													onclick={deleteDocumentHandler} size="x-small" title="Delete">
													</lightning-icon>
												</div>
											</div>
										</template> -->
									</div>
								</td>
								<td> <!-- Neelesh -->
									<template if:true={document.contentVersion}>
										<lightning-formatted-date-time
											value={document.contentVersion.CreatedDate}
											year="numeric"
											month="short"
											day="2-digit"
											hour="2-digit"
											minute="2-digit"
										></lightning-formatted-date-time>
									</template>
								</td>   		<!-- Neelesh-->
							</tr>
						</template>

						<template if:true={noDocuments}>
							<tr>
								<td colspan="3" style="text-align: center;">No documents found. </td>
							</tr>
						</template>
					</tbody>
				</table>
			</div>
		</template>
	</lightning-card>

</template>