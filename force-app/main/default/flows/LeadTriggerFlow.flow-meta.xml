<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Add4HoursToBusinessHours</name>
        <label>Add 4 Hours To Business Hours</label>
        <locationX>1654</locationX>
        <locationY>1955</locationY>
        <actionName>DateTimeUtility</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>UpdateTaskOwnerToAgentQueue</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>increment</name>
            <value>
                <numberValue>1.44E7</numberValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>methodName</name>
            <value>
                <stringValue>BusinessHours.add</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>businessHoursName</name>
            <value>
                <elementReference>BusinessHoursName</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>dateTimeString</name>
            <value>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </value>
        </inputParameters>
        <nameSegment>DateTimeUtility</nameSegment>
        <offset>0</offset>
        <outputParameters>
            <assignToReference>DueDateForReassigningLead</assignToReference>
            <name>resultDT</name>
        </outputParameters>
    </actionCalls>
    <actionCalls>
        <name>AddToBusinessHours</name>
        <label>Add To Business Hours</label>
        <locationX>1075</locationX>
        <locationY>2084</locationY>
        <actionName>DateTimeUtility</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>GetProfileId</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>increment</name>
            <value>
                <elementReference>Task1HoursToBeAdded</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>methodName</name>
            <value>
                <stringValue>BusinessHours.add</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>businessHoursName</name>
            <value>
                <elementReference>BusinessHoursName</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>dateTimeString</name>
            <value>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </value>
        </inputParameters>
        <nameSegment>DateTimeUtility</nameSegment>
        <offset>0</offset>
        <outputParameters>
            <assignToReference>DueDate</assignToReference>
            <name>resultDT</name>
        </outputParameters>
    </actionCalls>
    <actionCalls>
        <name>AgencyEmail</name>
        <label>Agency Email</label>
        <locationX>970</locationX>
        <locationY>1444</locationY>
        <actionName>Lead.AgencyAdminBrokerRegistrationsEmail</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>IsTheParentLeadOwnerCCASM</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>Lead.AgencyAdminBrokerRegistrationsEmail</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>Captivate_Email_Alert</name>
        <label>Captivate Email Alert</label>
        <locationX>635</locationX>
        <locationY>946</locationY>
        <actionName>Lead.Captivate_Email_Alert</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>Captivate_SMS_with_Whatsapp</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>Lead.Captivate_Email_Alert</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>Captivate_SMS_with_Whatsapp</name>
        <label>Captivate SMS with Whatsapp</label>
        <locationX>497</locationX>
        <locationY>1142</locationY>
        <actionName>BitlyShortenURL</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>BrokerLead</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>destination</name>
            <value>
                <elementReference>$Record.MobilePhone</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>lead</name>
            <value>
                <elementReference>$Record</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>smsBody</name>
            <value>
                <elementReference>CAPTIVATEWhatsappSMS</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>url</name>
            <value>
                <elementReference>WhatsAppLink</elementReference>
            </value>
        </inputParameters>
        <nameSegment>BitlyShortenURL</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>EmailToTheBroker</name>
        <label>Email To The Broker</label>
        <locationX>969</locationX>
        <locationY>1104</locationY>
        <actionName>Lead.BrokerPlatformRegistrations</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>CheckIfTheAgentHaveMobileNumber</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>Lead.BrokerPlatformRegistrations</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <description>To Send Email To Provis Team when the &apos;Property Usage&apos; is &apos;Residential Lease&apos;</description>
        <name>SendEmailToProvisTeam</name>
        <label>Send Email To Provis Team</label>
        <locationX>424</locationX>
        <locationY>1800</locationY>
        <actionName>Lead.ProvisResidentialLeaseLeads</actionName>
        <actionType>emailAlert</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>Lead.ProvisResidentialLeaseLeads</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>SendNotification</name>
        <label>Send Notification</label>
        <locationX>652</locationX>
        <locationY>1701</locationY>
        <actionName>customNotificationAction</actionName>
        <actionType>customNotificationAction</actionType>
        <connector>
            <targetReference>C4CLogic</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>customNotifTypeId</name>
            <value>
                <elementReference>CustomNotificationId.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>body</name>
            <value>
                <elementReference>NotificationBodyTemplate</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>title</name>
            <value>
                <stringValue>Duplicate Lead Created</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>recipientIds</name>
            <value>
                <elementReference>NotificationRecipientIds</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>targetId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>customNotificationAction</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>SendSMSToSM1_0</name>
        <label>Send SMS To SM</label>
        <locationX>1342</locationX>
        <locationY>1247</locationY>
        <actionName>SmsNotificationAPI</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>AgencyEmailIsPopulated</targetReference>
        </connector>
        <dataTypeMappings>
            <typeName>T__record</typeName>
            <typeValue>Lead</typeValue>
        </dataTypeMappings>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>destination</name>
            <value>
                <elementReference>$Record.BrokerAgent__r.MobilePhone</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>record</name>
            <value>
                <elementReference>$Record</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>smsBody</name>
            <value>
                <elementReference>AgentSMS</elementReference>
            </value>
        </inputParameters>
        <nameSegment>SmsNotificationAPI</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>SendWhatsAppLinkWithShortenURL</name>
        <label>Send WhatsApp Link With Shorten URL</label>
        <locationX>413</locationX>
        <locationY>906</locationY>
        <actionName>BitlyShortenURL</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>BrokerLead</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>destination</name>
            <value>
                <elementReference>$Record.MobilePhone</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>lead</name>
            <value>
                <elementReference>$Record</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>smsBody</name>
            <value>
                <elementReference>WhatsAppLinkSMS</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>url</name>
            <value>
                <elementReference>WhatsAppLink</elementReference>
            </value>
        </inputParameters>
        <nameSegment>BitlyShortenURL</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>StaffLeadReferralEmailAlert</name>
        <label>StaffLeadReferralEmailAlert</label>
        <locationX>1329</locationX>
        <locationY>295</locationY>
        <actionName>Lead.StaffLeadReferralEmailAlert</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>Check_for_Referral_Status</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>Lead.StaffLeadReferralEmailAlert</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>StaffLeadReferralEmailToManagement</name>
        <label>StaffLeadReferralEmailToManagement</label>
        <locationX>1074</locationX>
        <locationY>437</locationY>
        <actionName>Lead.StaffLeadReferralEmailToManagement</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>LeadStatusNotQualified</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>Lead.StaffLeadReferralEmailToManagement</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <apiVersion>53.0</apiVersion>
    <areMetricsLoggedToDataCloud>false</areMetricsLoggedToDataCloud>
    <assignments>
        <description>Assign Recipients for duplicate lead notification.</description>
        <name>AssignRecipients</name>
        <label>Assign Recipients</label>
        <locationX>652</locationX>
        <locationY>1460</locationY>
        <assignmentItems>
            <assignToReference>NotificationRecipientIds</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>$Record.ParentLead__r.OwnerId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>CustomNotificationId</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>CustomerResponseValue</name>
        <label>Customer Response Value</label>
        <locationX>1035</locationX>
        <locationY>2369</locationY>
        <assignmentItems>
            <assignToReference>CustomerResponse</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Customer Reached</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>UpdateLeadStatusToInProgress</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>SelectBusinessHoursName</name>
        <label>Select Business Hours Name</label>
        <locationX>885</locationX>
        <locationY>2235</locationY>
        <assignmentItems>
            <assignToReference>BusinessHoursName</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Aldar Business Hours</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>AddToBusinessHours</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>StatusValue</name>
        <label>StatusValue</label>
        <locationX>1073</locationX>
        <locationY>2512</locationY>
        <assignmentItems>
            <assignToReference>Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Completed</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>TaskNumber</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>GetTask1Day1RecordIfAlreadyCreated</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>AgencyEmailIsPopulated</name>
        <label>Agency Email Is Populated?</label>
        <locationX>960</locationX>
        <locationY>1243</locationY>
        <defaultConnector>
            <targetReference>IsTheParentLeadOwnerCCASM</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>AgencyEmail1</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.AgencyEmail__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>AgencyEmail</targetReference>
            </connector>
            <label>Agency Email</label>
        </rules>
    </decisions>
    <decisions>
        <name>BrokerLead</name>
        <label>Broker Lead</label>
        <locationX>779</locationX>
        <locationY>1061</locationY>
        <defaultConnector>
            <targetReference>IsTheParentLeadOwnerCCASM</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>SendEmailToBrokerLead</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.LeadSource</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Broker Portal</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.EnquiryCategory__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Broker/Agent</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.EnquiryTrigger__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Broker Agency Name</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Owner:Group.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Broker Queue</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>IsNew</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>EmailToTheBroker</targetReference>
            </connector>
            <label>Send Email To Broker Lead</label>
        </rules>
    </decisions>
    <decisions>
        <name>C4CLogic</name>
        <label>C4C Logic</label>
        <locationX>794</locationX>
        <locationY>1800</locationY>
        <defaultConnector>
            <targetReference>LeadOwnerChangedFromCCAToAgentQueue</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>PropertyUsageIsResidentialLease</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.PropertyUsage__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Residential Lease</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Status</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Closed</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SendEmailToProvisTeam</targetReference>
            </connector>
            <label>Property Usage Is Residential Lease</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_for_Referral_Status</name>
        <label>Check for Referral Status</label>
        <locationX>1512</locationX>
        <locationY>540</locationY>
        <defaultConnector>
            <targetReference>LeadStatusNotQualified</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>If_Its_Referred</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.StaffReferralStatus__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Referred</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StaffReferralStatus__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>StaffLeadReferralEmailToManagement</targetReference>
            </connector>
            <label>If Its Referred</label>
        </rules>
    </decisions>
    <decisions>
        <name>CheckIfTheAgentHaveMobileNumber</name>
        <label>Check If The Agent Have Mobile Number</label>
        <locationX>1226</locationX>
        <locationY>1115</locationY>
        <defaultConnector>
            <targetReference>AgencyEmailIsPopulated</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>SendSMSToAgent</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.BrokerAgent__r.MobilePhone</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SendSMSToSM1_0</targetReference>
            </connector>
            <label>Send SMS To Agent</label>
        </rules>
    </decisions>
    <decisions>
        <name>CreateTask1</name>
        <label>Create Task 1</label>
        <locationX>1074</locationX>
        <locationY>2941</locationY>
        <defaultConnector>
            <targetReference>SMDirectAssignment</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>CreateTask</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>GetTask1Day1RecordIfAlreadyCreated</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Task1</targetReference>
            </connector>
            <label>Create Task</label>
        </rules>
    </decisions>
    <decisions>
        <description>To check if the Lead created by CCA Profile or The new Lead Status is Retired.</description>
        <name>IsCreatedByCCAOrTheLeadStatusIsRetired</name>
        <label>Is Created By CCA Or The Lead Status Is Retired?</label>
        <locationX>1262</locationX>
        <locationY>2427</locationY>
        <defaultConnector>
            <targetReference>GetTask1Day1RecordIfAlreadyCreated</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>CreatedByCCAOrSM</name>
            <conditionLogic>1 OR 2 OR 5 OR  (3 AND 4)</conditionLogic>
            <conditions>
                <leftValueReference>GetProfileId.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Contact Centre Agent</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>GetProfileId.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Sales Manager</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.LeadSource</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Walk-In</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.ExemptFromAssignment__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>GetProfileId.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Resale Relationship Manager</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>CustomerResponseValue</targetReference>
            </connector>
            <label>Created By CCA Or SM Or Walk-In</label>
        </rules>
        <rules>
            <name>LeadStatusIsRetired</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.CreatedBy.Profile.Id</leftValueReference>
                <operator>StartsWith</operator>
                <rightValue>
                    <elementReference>CustomerCenterAgentId</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Duplicate Lead</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>StatusValue</targetReference>
            </connector>
            <label>Lead Status Is Retired</label>
        </rules>
    </decisions>
    <decisions>
        <name>IsTheLeadAssignedToCCA</name>
        <label>Is The Lead Assigned To CCA</label>
        <locationX>1067</locationX>
        <locationY>1876</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Owner:User.ProfileName__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Contact Centre Agent</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Owner:User.ProfileName__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Sales Manager</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Owner:User.ProfileName__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Resale Relationship Manager</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>UpdateLeadUpdateTask</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Yes</label>
        </rules>
        <rules>
            <name>OwnerUpdated</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.UpdateTasks__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Owner:User.ProfileName__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>UpdateLeadUpdateTask</targetReference>
            </connector>
            <doesRequireRecordChangedToMeetCriteria>true</doesRequireRecordChangedToMeetCriteria>
            <label>Owner Updated</label>
        </rules>
    </decisions>
    <decisions>
        <name>IstheNewOwnerIsAgentQueue</name>
        <label>Is the New Owner Is Agent Queue?</label>
        <locationX>1272</locationX>
        <locationY>1700</locationY>
        <defaultConnector>
            <targetReference>IsTheLeadAssignedToCCA</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>AgentQueue</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Owner:Group.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Agent Queue</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record__Prior.Owner:Group.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Agent Queue</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>GetUncompletedTasks</targetReference>
            </connector>
            <label>Agent Queue</label>
        </rules>
    </decisions>
    <decisions>
        <name>IsTheParentLeadOwnerCCASM</name>
        <label>Is The Parent Lead Owner CCA/SM?</label>
        <locationX>784</locationX>
        <locationY>1339</locationY>
        <defaultConnector>
            <targetReference>C4CLogic</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>CCASM</name>
            <conditionLogic>(1 OR 2 OR 5) AND 3 AND 4</conditionLogic>
            <conditions>
                <leftValueReference>$Record.ParentLead__r.Owner:User.ProfileName__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Contact Centre Agent</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.ParentLead__r.Owner:User.ProfileName__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Sales Manager</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>IsNew</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.ParentLead__r.Owner:User.IsActive</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.ParentLead__r.Owner:User.ProfileName__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Resale Relationship Manager</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>AssignRecipients</targetReference>
            </connector>
            <label>CCA/SM</label>
        </rules>
    </decisions>
    <decisions>
        <name>LeadIsCreatedFromOnlineChannel</name>
        <label>Lead Is Created From Online Channel</label>
        <locationX>516</locationX>
        <locationY>632</locationY>
        <defaultConnector>
            <targetReference>BrokerLead</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>SendWhatsAppLink</name>
            <conditionLogic>1 AND 2 AND 5 AND 6 AND 7 AND 8 AND 9 AND (3 OR 4)</conditionLogic>
            <conditions>
                <leftValueReference>IsNew</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.EnquiryTrigger__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Captivate</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.LeadSource</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Online</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.LeadSource</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Walk-In</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Campaign_Name__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>SquareRootsMarketing</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Campaign_Name__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>LondonSquareMarketing</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Campaign_Name__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>LondonSquareMarketingAsia</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.CreatedBy.Team__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>LSQ</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>isCreatedByRoleIsLSQ</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SendWhatsAppLinkWithShortenURL</targetReference>
            </connector>
            <label>Send Whats App Link</label>
        </rules>
        <rules>
            <name>Captivate_Leads</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.EnquiryTrigger__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Captivate</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>IsNew</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.LeadSource</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Online</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Lead_Project_Group__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>LSQ</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Captivate_Email_Alert</targetReference>
            </connector>
            <label>Captivate Leads</label>
        </rules>
    </decisions>
    <decisions>
        <name>LeadOwnerChangedFromCCAToAgentQueue</name>
        <label>Lead Owner Changed From CCA To Agent Queue</label>
        <locationX>1044</locationX>
        <locationY>1561</locationY>
        <defaultConnector>
            <targetReference>IsTheLeadAssignedToCCA</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>OwnerChanged</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.OwnerId</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>IstheNewOwnerIsAgentQueue</targetReference>
            </connector>
            <label>Owner Changed</label>
        </rules>
    </decisions>
    <decisions>
        <name>LeadStatusIsNotInProgressorNewLead</name>
        <label>Lead Status Is Not In Progress or New Lead or Retired</label>
        <locationX>782</locationX>
        <locationY>646</locationY>
        <defaultConnector>
            <targetReference>LeadIsCreatedFromOnlineChannel</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>True</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Status</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>New Lead</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Status</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>In Progress Lead</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Status</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Retired Lead</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>UpdateAssignmentStatus_0</targetReference>
            </connector>
            <label>True</label>
        </rules>
    </decisions>
    <decisions>
        <name>LeadStatusNotQualified</name>
        <label>Lead Status Not Qualified</label>
        <locationX>619</locationX>
        <locationY>404</locationY>
        <defaultConnector>
            <targetReference>UpdateAssignmentStatus</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>NotQualified</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Status</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Qualified Lead</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>LeadStatusIsNotInProgressorNewLead</targetReference>
            </connector>
            <label>Not Qualified</label>
        </rules>
    </decisions>
    <decisions>
        <name>Notify_the_Employee_on_Referral</name>
        <label>Notify the Employee on Referral</label>
        <locationX>1024</locationX>
        <locationY>277</locationY>
        <defaultConnector>
            <targetReference>LeadStatusNotQualified</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Notify_on_the_Referral_status</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.StaffReferralStatus__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.EmployeeEmail__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>StaffLeadReferralEmailAlert</targetReference>
            </connector>
            <label>Notify on the Referral status</label>
        </rules>
    </decisions>
    <decisions>
        <name>OwnerIsChanged123</name>
        <label>Owner Is Changed</label>
        <locationX>48</locationX>
        <locationY>662</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Changed</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>OwnerIsChanged</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <label>Changed</label>
        </rules>
    </decisions>
    <decisions>
        <name>SMDirectAssignment</name>
        <label>SM Direct Assignment</label>
        <locationX>636</locationX>
        <locationY>2849</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>SendNotificationToSM</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Owner:User.ProfileName__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Sales Manager</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Owner:User.ProfileName__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Resale Relationship Manager</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>UpdateAssignmentSLATime</targetReference>
            </connector>
            <label>Send Notification To SM</label>
        </rules>
    </decisions>
    <decisions>
        <name>SMOrCCABusinessHours</name>
        <label>SM Or CCA Business Hours</label>
        <locationX>882</locationX>
        <locationY>2081</locationY>
        <defaultConnector>
            <targetReference>AddToBusinessHours</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>SMBusinessHours</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Owner:User.ProfileName__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Sales Manager</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Owner:User.ProfileName__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Resale Relationship Manager</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SelectBusinessHoursName</targetReference>
            </connector>
            <label>SM Business Hours</label>
        </rules>
    </decisions>
    <decisions>
        <name>UpdateTaskOwner</name>
        <label>Update Task Owner</label>
        <locationX>1520</locationX>
        <locationY>1795</locationY>
        <defaultConnector>
            <targetReference>IsTheLeadAssignedToCCA</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>ChangeDueDate</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Owner:User.ProfileName__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>GetUncompletedTasks.Subject</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>TaskSubject</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Add4HoursToBusinessHours</targetReference>
            </connector>
            <label>Change Due Date</label>
        </rules>
        <rules>
            <name>Update</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>GetUncompletedTasks.Subject</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>TaskSubject</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>UpdateTaskOwnerToAgentQueue</targetReference>
            </connector>
            <label>Update</label>
        </rules>
        <rules>
            <name>Close_Task</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>GetUncompletedTasks.Subject</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>TaskSubject</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>UpdateOpenTask</targetReference>
            </connector>
            <label>Close Task</label>
        </rules>
    </decisions>
    <description>Modified Whatapp sending condition to exclude LSQ LEads. 06/10/25</description>
    <environments>Default</environments>
    <formulas>
        <name>DateTimePlus1Hour</name>
        <dataType>DateTime</dataType>
        <expression>{!$Flow.CurrentDateTime} + (VALUE({!$Label.DIRECTASSIGENMENT_SM_SLA})/24)</expression>
    </formulas>
    <formulas>
        <description>Return True if Lead created by LSQ User with Role Starts with LSQ</description>
        <name>isCreatedByRoleIsLSQ</name>
        <dataType>Boolean</dataType>
        <expression>IF(
    BEGINS({!$Record.CreatedBy.UserRole.Name}, &quot;LSQ&quot;),
    TRUE,
    FALSE
)</expression>
    </formulas>
    <formulas>
        <description>To check if its new Record</description>
        <name>IsNew</name>
        <dataType>Boolean</dataType>
        <expression>ISNEW()</expression>
    </formulas>
    <formulas>
        <name>OwnerIsChanged</name>
        <dataType>Boolean</dataType>
        <expression>ISCHANGED({!$Record.OwnerId})</expression>
    </formulas>
    <formulas>
        <name>Task1HoursToBeAdded</name>
        <dataType>Number</dataType>
        <expression>VALUE({!$Label.Task1}) * 3600000</expression>
        <scale>10</scale>
    </formulas>
    <formulas>
        <name>TaskSubject</name>
        <dataType>String</dataType>
        <expression>{!$Record.LeadNumber__c} + &apos; - Day 1 - Task 1&apos;</expression>
    </formulas>
    <interviewLabel>Lead Trigger Flow {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Lead Trigger Flow</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <description>To create Task 1</description>
        <name>Task1</name>
        <label>Task 1</label>
        <locationX>1084</locationX>
        <locationY>3121</locationY>
        <connector>
            <targetReference>UpdateLeadTaskType</targetReference>
        </connector>
        <inputAssignments>
            <field>ActivityDate</field>
            <value>
                <elementReference>DueDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>CustomerResponse__c</field>
            <value>
                <elementReference>CustomerResponse</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>IsReminderSet</field>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OwnerId</field>
            <value>
                <elementReference>$Record.OwnerId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Priority</field>
            <value>
                <stringValue>Normal</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ReminderDateTime</field>
            <value>
                <elementReference>DueDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status</field>
            <value>
                <elementReference>Status</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subject</field>
            <value>
                <elementReference>TaskSubject</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>TaskNumber__c</field>
            <value>
                <elementReference>TaskNumber</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>TaskType__c</field>
            <value>
                <stringValue>Day 1 - Task 1</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>WhoId</field>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <object>Task</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordLookups>
        <name>CustomNotificationId</name>
        <label>Custom Notification Id</label>
        <locationX>652</locationX>
        <locationY>1581</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>SendNotification</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>DuplicateLeadCreated</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>CustomNotificationType</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>GetProfileId</name>
        <label>Get Profile Id</label>
        <locationX>1271</locationX>
        <locationY>2190</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>IsCreatedByCCAOrTheLeadStatusIsRetired</targetReference>
        </connector>
        <filterLogic>or</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.CreatedBy.Profile.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Profile</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>GetTask1Day1RecordIfAlreadyCreated</name>
        <label>Get Task 1 - Day 1 Record If Already Created</label>
        <locationX>1073</locationX>
        <locationY>2784</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>CreateTask1</targetReference>
        </connector>
        <filterLogic>(1 AND 2 AND 3 AND 4) OR (5 AND 2) OR (1 AND 2 AND 6)</filterLogic>
        <filters>
            <field>Subject</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>TaskSubject</elementReference>
            </value>
        </filters>
        <filters>
            <field>WhoId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>CustomerResponse__c</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Status</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Open</stringValue>
            </value>
        </filters>
        <filters>
            <field>Subject</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>SM - Day 1 - Task 1</stringValue>
            </value>
        </filters>
        <filters>
            <field>CustomerResponse__c</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Task</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>GetUncompletedTasks</name>
        <label>Get Uncompleted Tasks</label>
        <locationX>1484</locationX>
        <locationY>1603</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>UpdateTaskOwner</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>WhoId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>Status</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Completed</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Task</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <description>Used to reassign the lead to another SM in case the SLA is Breached</description>
        <name>UpdateAssignmentSLATime</name>
        <label>Update Assignment SLA Time</label>
        <locationX>489</locationX>
        <locationY>3068</locationY>
        <inputAssignments>
            <field>AssignmentSLATime__c</field>
            <value>
                <elementReference>DueDate</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>UpdateAssignmentStatus</name>
        <label>Update Assignment Status</label>
        <locationX>56</locationX>
        <locationY>432</locationY>
        <connector>
            <targetReference>OwnerIsChanged123</targetReference>
        </connector>
        <inputAssignments>
            <field>AssignmentStatus__c</field>
            <value>
                <stringValue>Transferred</stringValue>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>UpdateAssignmentStatus_0</name>
        <label>Update Assignment Status</label>
        <locationX>976</locationX>
        <locationY>751</locationY>
        <connector>
            <targetReference>LeadIsCreatedFromOnlineChannel</targetReference>
        </connector>
        <inputAssignments>
            <field>AssignmentStatus__c</field>
            <value>
                <stringValue>Transferred</stringValue>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>UpdateLeadStatusToInProgress</name>
        <label>Update Lead Status To In Progress</label>
        <locationX>839</locationX>
        <locationY>2466</locationY>
        <connector>
            <targetReference>StatusValue</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>LeadSource</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Walk-In</stringValue>
            </value>
        </filters>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>In Progress Lead</stringValue>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>UpdateLeadTaskType</name>
        <label>Update Lead Task Type</label>
        <locationX>842</locationX>
        <locationY>3122</locationY>
        <connector>
            <targetReference>SMDirectAssignment</targetReference>
        </connector>
        <inputAssignments>
            <field>TaskType__c</field>
            <value>
                <stringValue>Day 1 - Task 1</stringValue>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>UpdateLeadUpdateTask</name>
        <label>Update Lead Update Task</label>
        <locationX>888</locationX>
        <locationY>1880</locationY>
        <connector>
            <targetReference>SMOrCCABusinessHours</targetReference>
        </connector>
        <inputAssignments>
            <field>AssignmentStatus__c</field>
            <value>
                <stringValue>Assigned</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>UpdateTasks__c</field>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>UpdateOpenTask</name>
        <label>Update Open Task</label>
        <locationX>1367</locationX>
        <locationY>1878</locationY>
        <connector>
            <targetReference>IsTheLeadAssignedToCCA</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>GetUncompletedTasks.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>ActivityDate</field>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Description</field>
            <value>
                <stringValue>Completed Due to Change The Owner.</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>IsReminderSet</field>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ReminderDateTime</field>
        </inputAssignments>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>Completed</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>TaskNumber__c</field>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </inputAssignments>
        <object>Task</object>
    </recordUpdates>
    <recordUpdates>
        <name>UpdateTaskOwnerToAgentQueue</name>
        <label>Update Task Owner To Agent Queue</label>
        <locationX>1527</locationX>
        <locationY>2047</locationY>
        <connector>
            <targetReference>IsTheLeadAssignedToCCA</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>GetUncompletedTasks.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>ActivityDate</field>
            <value>
                <elementReference>DueDateForReassigningLead</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OwnerId</field>
            <value>
                <elementReference>$Record.OwnerId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ReminderDateTime</field>
            <value>
                <elementReference>DueDateForReassigningLead</elementReference>
            </value>
        </inputAssignments>
        <object>Task</object>
    </recordUpdates>
    <start>
        <locationX>477</locationX>
        <locationY>33</locationY>
        <connector>
            <targetReference>Notify_the_Employee_on_Referral</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Lead_Type__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Options and Upgrades</stringValue>
            </value>
        </filters>
        <filters>
            <field>RecordTypeName__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>ECSS</stringValue>
            </value>
        </filters>
        <filters>
            <field>RecordTypeName__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Retail Lead</stringValue>
            </value>
        </filters>
        <object>Lead</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Draft</status>
    <textTemplates>
        <name>AgentSMS</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>Dear {!$Record.BrokerAgent__r.FirstName} {!$Record.BrokerAgent__r.LastName},
Thank you for registering your customer in Aldar properties. Your reference Lead No is: {!$Record.LeadNumber__c}. Please contact your sales executive.</text>
    </textTemplates>
    <textTemplates>
        <name>CAPTIVATEWhatsappSMS</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>Dear {!$Record.FirstName} {!$Record.LastName},
Thank you for registering your interest in {!$Record.Project__c}. A dedicated advisor will be reaching out to you within 24 hours. To chat with us directly via WhatsApp, please click here</text>
    </textTemplates>
    <textTemplates>
        <description>Notification Body Template</description>
        <name>NotificationBodyTemplate</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>Duplicate Lead Created for {!$Record.ParentLead__r.LeadNumber__c} and the new lead is {!$Record.LeadNumber__c}</text>
    </textTemplates>
    <textTemplates>
        <name>SMNotificationBodyTemplate</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>New Lead {!$Record.LeadNumber__c} Assigned To You.</text>
    </textTemplates>
    <textTemplates>
        <name>SMSMSBody</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>Dear, New Lead Assigned To you. Lead Name: {!$Record.Name}, Lead Number: {!$Record.LeadNumber__c}.</text>
    </textTemplates>
    <textTemplates>
        <name>WhatsappCaptivate</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>Hello {!$Record.FirstName}. Thank you for your interest in one of our properties at {!$Record.Project__c}. We have your details and our team will be in contact soon. ALDAR PROPERTIES PJSC.</text>
    </textTemplates>
    <textTemplates>
        <name>WhatsAppLink</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>https://wa.me/+97180025327?text=Hello, I&apos;m interested in {!$Record.Project__c} and I would like to know more about the project. My reference number is {!$Record.LeadNumber__c}</text>
    </textTemplates>
    <textTemplates>
        <name>WhatsAppLinkSMS</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>Dear {!$Record.FirstName} {!$Record.LastName},
Thank you for registering your interest in {!$Record.Project__c}. A dedicated advisor will be reaching out to you within 24 hours. To chat with us directly via WhatsApp, please click here</text>
    </textTemplates>
    <textTemplates>
        <name>WhatsAppLinkSMSWithoutLink</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>Thank you for your interest in Aldar Properties. Our advisor will contact you shortly.</text>
    </textTemplates>
    <variables>
        <name>BusinessHoursName</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <value>
            <stringValue>Aldar Contact Center</stringValue>
        </value>
    </variables>
    <variables>
        <name>CustomerCenterAgentId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <value>
            <stringValue>00e26000000NnDN</stringValue>
        </value>
    </variables>
    <variables>
        <name>CustomerResponse</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>DateTimeFromApexClass</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>DueDate</name>
        <dataType>DateTime</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <value>
            <elementReference>DateTimePlus1Hour</elementReference>
        </value>
    </variables>
    <variables>
        <name>DueDateForReassigningLead</name>
        <dataType>DateTime</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>IsWithinBusinessHours</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>NotificationRecipientIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>NotificationSMRecipientIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>Status</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <value>
            <stringValue>Open</stringValue>
        </value>
    </variables>
    <variables>
        <name>TaskNumber</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <scale>1</scale>
        <value>
            <numberValue>1.0</numberValue>
        </value>
    </variables>
</Flow>
